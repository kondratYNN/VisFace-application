# VisFace-application
## О программе
Данный проект представляет из себя **GUI-приложение на Python по нахождению и распознаванию лиц** в захвате камеры, используя библиотеку *OpenCV*. Для реализации базы данных использовалась *sqlite3*. GUI реализовано через *pyQt5*.
____
## Структура проекта
Пробные файлы:
* `face_detect.py` - просто определение лиц в захвате камеры, консольный вывод количества лиц
* `face_recogn.py` - распознавание лица(без связи с базой данных, загружается просто изображение)
* `face_recogn_count.py` - небольшое дополнение к предыдущему файлу, выводит количесво найденных лиц, среди них сколько распознано и список имен

В этих файлах много комментариев и по ним можно легко вникнуть в нюансы процесса. Независимы друг от друга и от GUI.

Так же проект содержит `database_flow.py`, вспомогательный модуль для тестирования базы данных, он не несет важных функций.

**Для работы GUI-приложения необходимы следующие файлы:**
* `face_proc.py` - класс для упрощенной работы с распознаванием лиц, этакая удобная обертка для *OpenCV*. Подробнее о нем будет написано ниже.
* `core.py` - логика функций распознавания, используемая во view, посредник между *face_proc* и *view*.
* `view.py` - отвечает за графический интерфейс многооконного приложения. Все классы для окон и их запуск находятся тут.
* `personality.db` - сама база данных приложения.
* папки `face_img` и `view_elements` - первая будет хранить изображения для базы данных, вторая графические и
элементы, используемые в GUI.
____
## O классе FaceProc

Класс, находящийся в `face_proc.py`,предоставляет легкое использование функций нахождения и распознавания лиц.

#### **Создание объекта класса**
При **создании** объекта необходима указать 2 параметра:
* `function`(поддерживает только 2 возможных значения: *'Detector'* - нахождение лиц, *'Recognition'* - распознавание)
* `count`(возвращение значений количество лиц в захвате камеры, список распознанных лиц и тд.) - значения *True* или *False*

По умолчанию стоит `function='Detector' и count=False`.

#### **Получение доступа к камере**
После создания объекта необходимо указать, откуда будет получено изображение.

Для этого используется метод класса `set_capture(self, source`.

Параметр `source` может иметь 3 значения:
* **'BASE'**(предпочтительный вариант) - доступ к встроенной камере ноутбука.
* **'USB'** - доступ к подключенной камере.
* '*путь к видео*' - использовать как ресурс видео.

#### **Подключение базы данных**
Если при создании объекта была указана функция ***'Recognition'***, необходимо установить связь с базой данных, откуда будут получены лица для распознавания (*в коде прописана БД* `personality.db`).

Для этого используется метод класса `set_face_base(self)`.

#### **Запуск**
За запуск процесса отвечает метод `start(self)`, за закрытие использования `close(self)`.

Пример создания функции для распознавания лиц используя объект класса FaceProc:
```python
def recognition():
    process_object = FaceProc(function='Recognition', count=True)
    process_object.set_capture('BASE') # Доступ ко встроенной камере
    process_object.set_face_base() # Установление связи с бзой данных
    face_amount, identified_face_names = process_object.start() # Возвращает максимальное количество лиц в захвате камеры и список имен распозннанных лиц
    process_object.close() # закрытие работы распознования
    return face_amount, identified_face_names

```
___
### Структура GUI-приложения
Приложение состоит из трёх окон:
* *MainMenu* - главное меню программы
* *Database* - окно для работы с базой данных программы
* *Recognition* - окно для работы с распознаванием лиц

Результаты распознавания лиц можно сохранить в *TXT* и *XLSX* форматах.
___
### Скриншоты
![MainMenu](screenshots/Main_menu.png "Main menu")

![Info](screenshots/Info.png "About program")

![DataBase](screenshots/Database.png "DataBase window")

![Recognition](screenshots/Recognition.png "Recognition window")

![Recognition_s](screenshots/Save.png "Recognition save window")
